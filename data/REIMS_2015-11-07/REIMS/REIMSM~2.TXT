
Richmond Eyeglass Inventory Matching System
USER MANUAL

Downloading and Installing REIMS 

Download REIMSFIL.zip and REIMSPRG.zip from  http://www.FriendsOfASAPROSAR.org/reims.html,
Unzip both in the same new folder -- we suggest naming it REIMS. 

To run the program, double-click REIMS.EXE. 

REIMS.EXE was written in FoxPro 2.6 for Windows. Although the program responds to mouse clicks, it was designed to operate with the keyboard for most functions. The idea here was that entry of data is keyboard-intensive and should not require a mouse to save or cancel entries. 

The program is intended to run on a single computer which is referred to as the Master. Other computers may be used in data entry -- the Export/Import section describes how that can be done. 

Running the Program 

Running Reims.exe brings up this menu bar: 



ALT plus the first letter in the menu name will execute the function - i.e., ALT i will run the Inventory function. Clicking on Inventory of course does the same. 

The various database files are discussed in the Backup/Restore section. Many spreadsheets including Excel and Quattro Pro can import these files for analysis. It is not advisable to modify or save the files with programs other than FoxPro however.

Getting Started 

Experiment with the basic functions using the sample files provided. These functions are described starting on page 12.
* 
ALT f will bring up the screen used to find matches. Enter a prescription and see the results. The field named Philscore ranks the glasses in inventory according to the best match. A score of zero is a perfect match. The minus sign is not needed when entering cylinders -- the program expects negative numbers. The program rounds to quarter diopters so 1.2 achieves the same result as 1.25. 

Next, ALT i will bring up three choices. Choose Add new serial numbers. A screen to add and edit prescriptions will appear. Typing a for Add will put the screen in the Add mode. The SKU field allows entry of a code if you wish. Hitting ENTER with or without a code will result in a serial number being assigned to the glasses. If this were for real, that number would be written on the bag containing the glasses in question. Enter a prescription. When you are done the Save button will be in focus and hitting ENTER will save the entry. Typing a will allow you to add another, c will close the screen. 
After closing the Adding new serial numbers screen, type ALT i again and choose Delete dispensed & junked glasses/Edit Rx's. That will bring up the Inventory deletion screen. Type l (lower-case L) for Locate and a browse screen will appear. Type a serial number to delete. That record should be then highlighted. Hitting ENTER will return you to the previous screen with the data for the glasses to be deleted. d for Dispense will delete the pair and keep a copy of the dispensed record. j for Junk will simply delete the pair.
Experiment with the sample file so you are comfortable searching, adding and deleting (the main program functions). Make sure you know how to back up and restore using the Backup/Restore menu item.
Now, to use the program with your own data, delete the sample data and assign a new beginning serial number. To do that go to Utilities and choose Remove all records in the file. Next, under Utilities, choose Change next serial number and assign a new number. 

It is recommended that you read How to perform the basic functions starting on page 12 before entering your own inventory. 
For entering on more than one computer, read about the Export/Import menu functions as well as Change next serial number under the Utilities menu. 

Inventory (there are three options) 



1. Delete dispensed & junked glasses/Edit Rx’s
A screen (see below) will pop up. 



To access the glasses to be deleted, use Locate.




and a browse screen will pop up. 


Type the serial number in question. The record should then be highlighted, and hitting ENTER will return to the data screen with data for that record. For deleting broken and deteriorated glasses, type j for Junked and for dispensed glasses type d for Dispensed. The program will maintain a file of dispensed glasses, with the dispensed date for later analysis. 
* 
To edit the entry use the Edit button. 



2. Add new serial numbers
A screen (see below) will pop up containing data for the first serial number in the database. (SKU is the stock-keeping unit. The serial number is preceded by a colon. Serial numbers are added automatically by the program when new glasses are added.) 


Add new serial numbers screen example

The buttons at the bottom of the screen - Top, Previous, Next, End, Locate, Add, Edit, Delete, Close - are active at this point. The leftmost four buttons are rarely used but allow navigation. Locate pops up a browse screen in serial number order. 

Typing the serial number while the Locate browse is running will highlight the record in question. Hitting ENTER will return to the data screen with data for that record. The buttons will then be active so that typing the letter e will allow you to edit the data, c will close the screen, d will display a message that deletions should be made using another screen, a will clear the screen for adding a new entry and the SKU field will be highlighted. 

The Add button becomes Save and the Delete button becomes Cancel. All other buttons become inactive. 

A colon and serial number will appear after you hit ENTER. If you type anything in the SKU field, the colon and number will be added to the end. 

The program will force completion of Type, Gender and Size with valid letters. Tint and Material are optional. The Rx entry will skip the Add field unless the type is B (for bifocal). Cylinders are converted to negative numbers automatically - no positive cylinders are expected. All entries result in quarter increments. Therefore 1.2 results in 1.25, 1.5 in 1.50 and 1.7 in 1.75. The default choice will fill in the OS Rx with the OD Rx automatically so if they are the same you can tab through them. If that is not desired, the OS Auto Check box can be unchecked (here the mouse does that best). The entry date field is filled in automatically. 

After all the data is entered, the Save button is in focus and hitting s or ENTER will save the record. Cancel will cancel the addition. 

Data can be entered on other computers as described in the Export/Import section. 



3. Reuse deleted numbers 
A screen similar to the Add New Serial Numbers screen will pop up. Using the Add button will assign a number preceded by “R”, the year number and “:” (i.e. R08:) taken from a file of numbers which have been deleted and therefore available (created initially by Make file of  available numbers under Utilities ). Adding can be performed on the master computer or  non-masters – see Make files for entering re-used numbers under Utilities (This feature was added because ASAPROSAR has 10,000 glasses in SKU serial number sequence stored in bins with preset ranges of numbers. As the bins empty, the open slots are filled with new inventory.) 
 
Find match 

A screen (see below) will pop up to allow entry of the Rx. Radio buttons for OD, OS or Both can be marked with the spacebar  to direct the search for either or both eyes. Once the type - Single vision or Bifocal -- is chosen, the Rx can be entered. Half-diopter tolerances are used but can be changed. Once the Rx is entered, the Search button is active and hitting Enter starts a search. 


Find Match screen example

The program will announce if it is unsuccessful; otherwise a browse screen (see below) will pop up with the best candidates at the top. The field to the right of SKU is Philscore. This is a ranking of the candidates. The search algorithm was developed with the direction of Philip Richmond OD to rank the candidates by recognizing spherical equivalents, sphere and cylinder differences and cylinder-driven axis tolerances. A Philscore of zero is a perfect match. 

Search Results screen example


Readers 


This feature allows tracking of readers. 
1. Dispensed entry
This screen allows input of the sphere of a dispensed reader. The date is automatically added to the stored record. 

2. Add to inventory
This screen allows input of new quantities of readers. It asks for sphere, quantity and date added. 

3. Inventory count input
This screen allows input of inventory counts. It asks for sphere, count and date counted. 

4. Usage report
This screen will generate a report on usage. 



5. Inventory report
This screen will generate an inventory report. The report uses the dates entered in add, count and dispensed to arrive at its numbers. 

The reader inventory functions numbers 2, 3 and 5 are not used by ASAPROSAR but numbers 1 and 4 are used to keep a record of readers dispensed.


Search aids and reports 


The menu items are generally self explanatory. Running a menu function does not affect any file. 

File view by type and right eye:
Displays browse of inventory ordered by type, OD sphere and cylinder. 

File view by type and left eye: 
Displays browse of inventory ordered by type, OS sphere and cylinder.
 
Spherical equivalents 
This screen was included to allow an Rx to be entered and the possible spherical equivalents  for manual searches. The axis tolerances are shown as well. Entering 5.00 x -5.00 will produce a table which allows one to inspect the axis tolerances being used. 

Dispensed report:
This screen will generate a report of glasses dispensed for any date range. 

Inventory print:
Displays browse of inventory ordered by type, OD sphere and cylinder. Ctrl+P will print the inventory and Ctrl+F will print to a file. 

Inventory summary: 
Displays browse of inventory ordered by type, OD sphere and cylinder and quantity in inventory for each combination. 

Dispensed & inventory analysis
Brings up the following screen which reports dispensed data (number of bifocals, single vision and breakdown of OD plus, minus and plano for each) and the same data for current inventory.  After entering the campaign begin and end dates, the Find data button will be in focus. Hitting Enter will collect the data.



Export/Import (four options) 


These functions were developed to allow entry of data on different computers from the Master. Basically the non-master computers can export records of new serial numbers entered from a chosen date onward. The master can then import these records. It imports only records with serial numbers higher than its highest and resets its next serial number file to the number beyond the highest imported number.  

For entering on multiple computers, see the discussion in the Utility section under Change Next Serial Number. 

1. Export new serial numbers 
Creates a file on a non-master computer with new records from a specific date onward. 

2. Import new serial numbers 
Looks for the file created above and adds the data with serial numbers higher than the Master to the master file. 

3. Export re-used numbers
Creates a file with re-used serial numbers made by Inventory – Re-use Deleted Numbers option on a non-master computer. 

4. Import re-used numbers
If the Inventory - Reuse Deleted Numbers option has been used on the master computer, the program will recognize that and update the master file with the re-used numbers and make a new file of available numbers. If there is no re-used number data on the master, the program will look for a file with re-used number data and update the master. It will then make a new file of available numbers, remove all old re-used number data and do a backup.

Backup/Restore (two options) 


1. Backup will zip the data files to a chosen drive allowing the operator to name the zipped file. 

2. Restore will look for a file chosen by the operator and restore the files. Restoring will obviously overwrite all the data so it is not to be done lightly. Restore will be done frequently on a non-master computer adding re-used numbers to be exported to the master. The restore provides the available numbers and a fresh empty file to be used for new glasses. The restoration process will ask before overwriting each file -- thus individual files can be restored. 

The files backed up are: 

Bulog.dbf -- a log of backups – also contains the location of the clinic to appear in the window title if desired

Deleted.dbf -- a file of available numbers to be reused created by the Utilities - Make file of available numbers or by Export/Import - Import re-used numbers

Dispense.dbf -- a file containing a record of dispensed glasses

Glnxtno.dbf -- a file containing the next serial number to be used

Glsku.dbf -- the eyeglass inventory database

Glsku.cdx -- the accompanying index file that allows the data to be displayed in the correct order

Notfound.dbf -- a file containing the Rx’s of unsuccessful searches

Rdadd.dbf -- a file for recording additions to reader inventory

Rdinv.dbf -- the reader inventory database

Rdinv.cdx -- the accompanying index

Rdtrak.dbf -- a file containing a record of dispensed readers

Readd.dbf -- a file with data entered to replace used numbers

Readd.cdx -- the accompanying index

Reimshlp.dbf -- the help file



Utilities  



1. Available slots
Shows the number of deleted numbers which can be re-used.

2. View re-used numbers file
Shows numbers that will appear when using the Re-use deleted numbers option under Inventory

3. View serial number status
Shows all serial numbers with deletes noted

4. View unsuccessful searches
The Rx’s of unsuccessful searches are saved. This browses the file

5. Make file of available numbers
Creates a file of re-used numbers for use by Inventory - Re-use deleted numbers 

6. Make files for entering re-used numbers
Brings up the following screen to divide up the re-used number for entry on multiple computers. It creates files to be used to restore on each with unique numbers. After each non-master computer operator has completed entry, he/she must use Export/Import – Export re-used numbers. The exported files must be imported by the Master by using Export/Import – Import re-used numbers. 


Friends of ASAPROSAR  has found that large egg cartons will hold 400 glasses so we ask each entry person to fill a box. If 400 per box is checked, the program will assign the number of people to fill egg cartons.

5. Set up new database 

a. Change Next Serial Number
This utility allows the operator to change the serial number to be assigned to the next pair of glasses added. This will be used when a new inventory file is started. It also can be used to allow one or more non-Master computers to be used in data entry. Since the system relies on unique serial numbers, all computers must be assigning different series of numbers. Since the import of new serial numbers (see Export/Import) adds only records with serial numbers higher than those already on the Master, care must be taken in adding records exported from more than one computer.

b. Remove all records in the file
This utility removes all the records in the file. When the program is downloaded, the files included are ASAPROSAR data files. It is intended that new users experiment with those files. When it is decided to use the program and new data is to be entered, this utility will remove the ASAPROSAR data. Usually the serial number utility will be used in conjunction with removing the data so a new number series can be started. 

c. Browse all 
This allows one to browse the database including the deleted records. (When records are deleted, they are actually marked so the program does not use or show them.). Records which have been deleted in error can be recovered this way. (There is a box at the extreme left of the record which is blacked in if has been deleted. A mouse click can remove the black and restore the record.) 

d. Change location in window title 
Allows a  name to be entered to appear in the window title – useful when dealing with multiple clinics



How to perform the basic functions 

How to find a match 
1. Type ALT f to run the Find match menu item (or click on Find match; however, the program rarely needs the mouse). 



2. The Search for matches screen will pop up to allow entry of a prescription. The buttons on the top -- OD, OS and Both - allow a search for either or both eyes. Use the right arrow key and hit the space bar to mark your choice and hit TAB to move to Type. Hit ENTER three times to choose Both. 

3. In Type, use s for single vision or b for bifocal. 

4. Enter the prescription. The program rounds everything to ¼ diopters. Thus, 1.2 results in 1.25 and -2.7 in -2.75. The program converts any cylinder entry to a negative number. It also puts the OD prescription in the OS fields. When OU prescriptions are encountered, simply tab through the OS side. Otherwise overwrite the differences. 

5. After the prescription is entered the Search button is in focus. Hit ENTER or type s to start the search. 



A browse screen like the one above will appear unless the search is unsuccessful in which case a message box will appear. The browse screen will show the possible candidates in order of the best match. The field named Philscore shows a relative ranking with zero being perfect. 

6. Hit ESC to return to the Search for matches screen 

When finished searching, type c for Close or hit TAB to mark the Close button and then hit ENTER. 

Special problems 
There are three check boxes at the bottom of the screen that are used rarely and do need a mouse to select. First -- the tolerance can be relaxed. Second -- cylinder and axis can be ignored in the search (with high spheres, cylinder and axis can sometimes be ignored). Third - when a bifocal search is unsuccessful, the program will search for two single vision pairs. 


How to delete dispensed and junked glasses 
Always delete on the Master only. A search can be done on a non Master but unless it has just been restored to match the Master it can find glasses already dispensed. 

1.Type ALT i to pull down the Inventory menu item. Choose Delete dispensed and junked glasses/Edit Rx’s by hitting ENTER or d. That will bring up the Eyeglass inventory deletion and Rx editing screen. 



2.Type Enter or l (lower-case L) for Locate and a browse screen will appear.



 3.Type in the serial number of the glasses to be deleted (the number must be typed quickly without pauses between the digits). The record should then be highlighted. 

4. Hit ENTER to bring back the screen with the data for the glasses to delete. 

5.To dispense, type d for Dispensed and the program will keep a copy of that record with the date for later analysis. To junk, type j for Junked. In each case a confirmation message will appear with the OK button in focus. To cancel the delete, type c for Cancel. To delete, hit ENTER or type o (lower-case letter O) for OK. 
When finished deleting, type c for Close or TAB to the Close button and then hit ENTER. 


How to backup 
1. Type ALT b for Backup/Restore and then hit ENTER or type b for Backup. 
	That brings up the Back up screen with the cursor blinking at the beginning of the Backup name field. 



2. Enter the backup file name. The field will have a default name starting with an "R" and then the current date. If the date is Jan. 17, 2003 the field will read "R011703". Change the name if you wish. 3 1/2 disks can hold more than one backup, an "a" could be added to the first backup name and "b" to the next. It is best to be using several disks in rotation as well.  Flash drives (which have become ubiquitous since the basic program was written in 1996) are used often now.

3. Once the name is complete, hit ENTER . The OK button will be in focus. 

4. Hit ENTER or o (lower-case letter O) to start the backup. 

5. A box will ask OK to backup now? with the Cancel button in focus. To cancel hit ENTER. To continue backing up, type o (lower-case letter O) for OK. 

6. A Save as message box will appear for choosing the file destination and saving the file. 

How to restore 
1. Type ALT b for Backup/Restore and r for Restore. 

2. A Windows navigation box will appear. Find the restore file and click on Open. 

3.OK to restore now? with the Cancel button in focus will appear. To cancel hit ENTER. To continue restoring, type o (lower-case letter O) for OK. 
	A black screen will appear and the message "Warning! *****.DBF already exists. Overwrite (y/n/a/r)?" Type a for all and the restore should proceed. Watch the black screen for other messages. They are rare but usually let you know if the restore has problems. If only some files need to be restored, type n for the ones you don't want and y for the ones you do want. 


How to enter new serial numbers 
1. Type ALT i for Inventory menu and type a for Add new serial numbers. 
The Adding new serial numbers screen will appear. 



2. Type a for Add. The program will allow data to be inserted in the SKU but will assign a serial number preceded by a colon when Enter is typed. The program will force completion of Type, Gender and Size with valid letters. Tint and Material are optional. The Rx entry will skip the Add field unless the type is B (for bifocal). Cylinders are converted to negative numbers automatically - no positive cylinders are expected. All entries result in quarter increments. Therefore 1.2 results in 1.25, 1.5 in 1.50 and 1.7 in 1.75. The program will fill in the OS Rx with the OD Rx automatically, so if they are the same you can tab through them. If that is not desired, the OS Auto check box can be unchecked (here the mouse does that best). The entry date is filled in automatically. Enter the Rx.  

3. When the prescription has been entered the Save button is in focus. Hitting ENTER will save the record. Type a to start a new add. 

If the new numbers are added on a non Master, the records must be exported from the non Master and then imported on the Master 


How to Export new serial numbers from a non Master 
1.	Type ALT e for Export/Import and choose Export new serial numbers. 



2. A screen will appear asking for a beginning date of entry. Choose a date so the records to be exported will be included and o (lower-case letter O) for OK.  *See note following import instructions. 

3. A Save as box will appear allowing the export file to be named. The default name is Export.  Usually that file is renamed to avoid confusion when importing.

4. Choosing Save will result in the records to  be exported. Generally the records will be copied to a disk or a flash drive 

How to import new serial numbers to the Master 

1. Type ALT e for Export/Import and choose Import new serial numbers. 

2. An Open window will appear allowing the import file to be found. 

3. Choose the file to be imported and then Import. The number of imported records will be reported. 

*The import process will not add any record with a serial number lower that the highest number on file. Therefore records already exported in the date range and imported on the Master will be ignored. 

How to add new inventory using deleted numbers 

Overview 
If re-used numbers are entered on the Master, before entering for the first time, make a file of available numbers using the Make file of available numbers option under Utilities. Then use Re-use deleted numbers under Inventory described on page 19
Entering re-used numbers on several non-Masters

The system in brief: 

1. Files are made for restoring non-Master computers entering by choosing Make files for entering re-used numbers under Utilities to provide a unique set of re-used numbers for each.

2. Restore is performed on the non- Masters using the files.

3. Glasses are entered by using the Re-use deleted numbers option under Inventory  (The new records are added to a file named READD.DBF) 

4. The reused numbers are exported using the Export re-used numbers option under Export/Import. 
The file has a default name of READD.DBF but is generally renamed to avoid confusion.

5. The newly made and renamed READD.DBF is  then imported by the Master using the Import re-used numbers option under Export/Import. The records are then updated on the Master. 

6. Once the inventory file is updated, all the records in READD.DBF are deleted on the Master, a new file of available numbers is created and the backup process is automatically started. 

The backup and creation of a new file of available numbers happens for each import. The order of import does not matter.

How to enter re-used numbers 

1. Type ALT i for Inventory  menu and choose Re-use deleted numbers. 
The Re-used serial numbers screen will appear. 



2. Type a for Add. The program will insert the next available number in the SKU field preceded by "R" and the last two digits of the year. "R04" would appear during 2004. The program will force completion of Type, Gender and Size with valid letters. Tint and Material are optional. The Rx entry will skip the Add field unless the type is B (for bifocal). Cylinders are converted to negative numbers automatically - no positive cylinders are expected. All entries result in quarter increments. Therefore 1.2 results in 1.25, 1.5 in 1.50 and 1.7 in 1.75. The default choice will fill in the OS Rx with the OD Rx automatically, so if they are the same you can tab through them. If that is not desired, the OS Auto check box can be unchecked (here the mouse does that best). The entry date is filled in automatically. Enter the Rx.

3. When the prescription has been entered the "Save" button is in focus. Hitting ENTER will save the record. 
Type a to start a new add. 

When returning to  Re-use deleted numbers after entering new glasses and leaving the screen and/or shutting down the computer, the program will announce the number you have added to that point. 
 
How to Export reused numbers from a non Master 

1. Type ALT e for Export/Import and choose Export re-used numbers. 

2. A confirmation box will ask Ok to export now? with the Cancel button in focus. To cancel hit ENTER. To continue exporting, type o (lower-case letter O) for OK. 

3. A Save as box will appear. The default file name will be READD.DBF but it is advisable to rename the file to avoid confusion. Choose a destination 

4. Choose Save to export the file. Hit ENTER and the file will be exported and a message confirming the number of exported records will appear. 


How to import reused numbers to the Master 

1. Type ALT e for Export/Import and choose Import re-used numbers. 

2. A confirmation box will ask Ok to import now? with the Cancel button in focus. To cancel hit ENTER. To continue importing, type o (lower-case letter O) for "OK. An "Open" box will appear. Select the file to be imported.. The program will import the file and proceed to update the master file. A message confirming the number of records updated will appear. The program will then delete all records on READD.DBF and create a file of available numbers*.  

3. The backup procedure will be started automatically at this point. Follow the instructions above under How to backup. 


Contact Skip Charles (Email: hjcharles@post.harvard.edu) with questions, comments, suggestions. 

Rev 9.2
??

??

??

??









1


